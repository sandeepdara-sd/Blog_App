{"ast":null,"code":"import React,{useEffect}from'react';import Header from'./components/Header.js';import{Routes,Route,Navigate}from'react-router-dom';import Auth from'./components/Auth.js';import Blogs from'./components/Blogs.js';import UserBlog from'./components/UserBlog.js';import AddBlog from'./components/AddBlog.js';import BlogDetail from'./components/BlogDetail.js';import{useDispatch,useSelector}from'react-redux';import{authActions}from'./store/index.js';import Signup from'./components/Signup.js';import First from'./components/First.js';import UserInfo from'./components/UserInfo.js';import Loading from'./components/Loading.js';// Added\n// Import the enhanced CSS\nimport'./App.css';// Protected Route Component - Enhanced\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,isLoggedIn,isLoading,isInitialized}=_ref;// Show loading while checking authentication\nif(isLoading||!isInitialized){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'60vh'},children:/*#__PURE__*/_jsx(Loading,{message:\"Checking authentication...\"})});}// Redirect to First.js only if we're sure user is not logged in\nif(!isLoggedIn){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return children;};const App=()=>{const dispatch=useDispatch();const{isLoggedIn,isLoading,isInitialized}=useSelector(state=>({// Updated\nisLoggedIn:state.isLoggedIn,isLoading:state.isLoading,isInitialized:state.isInitialized}));useEffect(()=>{// Updated\nconst checkAuthStatus=async()=>{try{const userId=localStorage.getItem(\"userId\");if(userId){// Set loading state\ndispatch(authActions.setLoading(true));// You can optionally verify the user with the backend here\n// For now, we'll just restore the login state\ndispatch(authActions.login({_id:userId}));}else{// No user ID found, mark as not logged in\ndispatch(authActions.setLoading(false));dispatch(authActions.setInitialized(true));}}catch(error){console.error('Error checking auth status:',error);// On error, clear auth and mark as initialized\nlocalStorage.removeItem(\"userId\");dispatch(authActions.logout());}};checkAuthStatus();},[dispatch]);return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"main\",{className:\"main-content\",style:{marginTop:'80px'},children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(First,{})}),/*#__PURE__*/_jsx(Route,{path:\"/auth\",element:/*#__PURE__*/_jsx(Auth,{})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:/*#__PURE__*/_jsx(Signup,{})}),/*#__PURE__*/_jsx(Route,{path:\"/blogs\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,isLoading:isLoading,isInitialized:isInitialized,children:/*#__PURE__*/_jsx(Blogs,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/blogs/add\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,isLoading:isLoading,isInitialized:isInitialized,children:/*#__PURE__*/_jsx(AddBlog,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/myBlogs\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,isLoading:isLoading,isInitialized:isInitialized,children:/*#__PURE__*/_jsx(UserBlog,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/myBlogs/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,isLoading:isLoading,isInitialized:isInitialized,children:/*#__PURE__*/_jsx(BlogDetail,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/user-details/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,isLoading:isLoading,isInitialized:isInitialized,children:/*#__PURE__*/_jsx(UserInfo,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:isInitialized&&!isLoggedIn?/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true}):/*#__PURE__*/_jsx(First,{})})]})})]});};export default App;","map":{"version":3,"names":["React","useEffect","Header","Routes","Route","Navigate","Auth","Blogs","UserBlog","AddBlog","BlogDetail","useDispatch","useSelector","authActions","Signup","First","UserInfo","Loading","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","isLoggedIn","isLoading","isInitialized","style","display","justifyContent","alignItems","minHeight","message","to","replace","App","dispatch","state","checkAuthStatus","userId","localStorage","getItem","setLoading","login","_id","setInitialized","error","console","removeItem","logout","className","marginTop","path","element"],"sources":["D:/updated_blog/Blog_App/frontend/src/App.js"],"sourcesContent":["import React, { useEffect } from 'react'\nimport Header from './components/Header.js'\nimport {Routes,Route, Navigate} from 'react-router-dom'\nimport Auth from './components/Auth.js'\nimport Blogs from './components/Blogs.js'\nimport UserBlog from './components/UserBlog.js'\nimport AddBlog from './components/AddBlog.js'\nimport BlogDetail from './components/BlogDetail.js'\n\nimport {useDispatch, useSelector} from 'react-redux'\nimport { authActions } from './store/index.js'\nimport Signup from './components/Signup.js'\nimport First from './components/First.js'\nimport UserInfo from './components/UserInfo.js'\nimport Loading from './components/Loading.js' // Added\n\n// Import the enhanced CSS\nimport './App.css'\n\n// Protected Route Component - Enhanced\nconst ProtectedRoute = ({ children, isLoggedIn, isLoading, isInitialized }) => {\n  // Show loading while checking authentication\n  if (isLoading || !isInitialized) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '60vh' \n      }}>\n        <Loading message=\"Checking authentication...\" />\n      </div>\n    );\n  }\n  \n  // Redirect to First.js only if we're sure user is not logged in\n  if (!isLoggedIn) {\n    return <Navigate to=\"/\" replace />;\n  }\n  \n  return children;\n};\n\nconst App = () => {\n  const dispatch = useDispatch()\n  const { isLoggedIn, isLoading, isInitialized } = useSelector(state => ({ // Updated\n    isLoggedIn: state.isLoggedIn,\n    isLoading: state.isLoading,\n    isInitialized: state.isInitialized\n  }))\n  \n  useEffect(() => { // Updated\n    const checkAuthStatus = async () => {\n      try {\n        const userId = localStorage.getItem(\"userId\");\n        if (userId) {\n          // Set loading state\n          dispatch(authActions.setLoading(true));\n          \n          // You can optionally verify the user with the backend here\n          // For now, we'll just restore the login state\n          dispatch(authActions.login({ _id: userId }));\n        } else {\n          // No user ID found, mark as not logged in\n          dispatch(authActions.setLoading(false));\n          dispatch(authActions.setInitialized(true));\n        }\n      } catch (error) {\n        console.error('Error checking auth status:', error);\n        // On error, clear auth and mark as initialized\n        localStorage.removeItem(\"userId\");\n        dispatch(authActions.logout());\n      }\n    };\n\n    checkAuthStatus();\n  }, [dispatch]);\n  \n  return (\n    <div className=\"app\">\n      <Header/>\n      <main className=\"main-content\" style={{ marginTop: '80px' }}>\n        <Routes>\n          {/* Public Routes - Always accessible */}\n          <Route path='/' element={<First/>} />\n          <Route path='/auth' element={<Auth/>} />\n          <Route path='/signup' element={<Signup/>} />\n          \n          {/* Protected Routes - Enhanced protection */}\n          <Route path='/blogs' element={\n            <ProtectedRoute isLoggedIn={isLoggedIn} isLoading={isLoading} isInitialized={isInitialized}>\n              <Blogs/>\n            </ProtectedRoute>\n          } />\n          <Route path='/blogs/add' element={\n            <ProtectedRoute isLoggedIn={isLoggedIn} isLoading={isLoading} isInitialized={isInitialized}>\n              <AddBlog/>\n            </ProtectedRoute>\n          } />\n          <Route path='/myBlogs' element={\n            <ProtectedRoute isLoggedIn={isLoggedIn} isLoading={isLoading} isInitialized={isInitialized}>\n              <UserBlog/>\n            </ProtectedRoute>\n          } />\n          <Route path='/myBlogs/:id' element={\n            <ProtectedRoute isLoggedIn={isLoggedIn} isLoading={isLoading} isInitialized={isInitialized}>\n              <BlogDetail/>\n            </ProtectedRoute>\n          } />\n          <Route path=\"/user-details/:id\" element={\n            <ProtectedRoute isLoggedIn={isLoggedIn} isLoading={isLoading} isInitialized={isInitialized}>\n              <UserInfo />\n            </ProtectedRoute>\n          } />\n          \n          {/* Fallback Route - Only redirect if we're sure user is not logged in */}\n          <Route path=\"*\" element={\n            isInitialized && !isLoggedIn ? <Navigate to=\"/\" replace /> : <First/>\n          } />\n        </Routes>\n      </main>\n    </div>\n  )\n}\n\nexport default App\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}